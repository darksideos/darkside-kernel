This code was taken and modified by Artemis Tosini from https://github.com/brianwiddas/pi-baremetal